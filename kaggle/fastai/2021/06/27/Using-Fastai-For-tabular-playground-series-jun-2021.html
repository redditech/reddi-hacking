<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Using Fastai Tabular For Tabular Playground Series June 2021 Competition | reddi-hacking</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Using Fastai Tabular For Tabular Playground Series June 2021 Competition" />
<meta name="author" content="Nissan Dookeran" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here I use fastai with some changes to the defaults to make a submission to Kaggle for the Tabular Playground Series June 2021 competition." />
<meta property="og:description" content="Here I use fastai with some changes to the defaults to make a submission to Kaggle for the Tabular Playground Series June 2021 competition." />
<link rel="canonical" href="https://redditech.github.io/reddi-hacking/kaggle/fastai/2021/06/27/Using-Fastai-For-tabular-playground-series-jun-2021.html" />
<meta property="og:url" content="https://redditech.github.io/reddi-hacking/kaggle/fastai/2021/06/27/Using-Fastai-For-tabular-playground-series-jun-2021.html" />
<meta property="og:site_name" content="reddi-hacking" />
<meta property="og:image" content="https://redditech.github.io/reddi-hacking/images/chart-preview.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-27T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://redditech.github.io/reddi-hacking/kaggle/fastai/2021/06/27/Using-Fastai-For-tabular-playground-series-jun-2021.html","@type":"BlogPosting","headline":"Using Fastai Tabular For Tabular Playground Series June 2021 Competition","dateModified":"2021-06-27T00:00:00-05:00","datePublished":"2021-06-27T00:00:00-05:00","image":"https://redditech.github.io/reddi-hacking/images/chart-preview.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://redditech.github.io/reddi-hacking/kaggle/fastai/2021/06/27/Using-Fastai-For-tabular-playground-series-jun-2021.html"},"author":{"@type":"Person","name":"Nissan Dookeran"},"description":"Here I use fastai with some changes to the defaults to make a submission to Kaggle for the Tabular Playground Series June 2021 competition.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/reddi-hacking/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://redditech.github.io/reddi-hacking/feed.xml" title="reddi-hacking" /><link rel="shortcut icon" type="image/x-icon" href="/reddi-hacking/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/reddi-hacking/">reddi-hacking</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/reddi-hacking/about/">About Me</a><a class="page-link" href="/reddi-hacking/search/">Search</a><a class="page-link" href="/reddi-hacking/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Using Fastai Tabular For Tabular Playground Series June 2021 Competition</h1><p class="page-description">Here I use fastai with some changes to the defaults to make a submission to Kaggle for the Tabular Playground Series June 2021 competition.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-06-27T00:00:00-05:00" itemprop="datePublished">
        Jun 27, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Nissan Dookeran</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      20 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/reddi-hacking/categories/#kaggle">kaggle</a>
        &nbsp;
      
        <a class="category-tags-link" href="/reddi-hacking/categories/#fastai">fastai</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/redditech/reddi-hacking/tree/master/_notebooks/2021-06-27-Using-Fastai-For-tabular-playground-series-jun-2021.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/reddi-hacking/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/redditech/reddi-hacking/master?filepath=_notebooks%2F2021-06-27-Using-Fastai-For-tabular-playground-series-jun-2021.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/reddi-hacking/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/redditech/reddi-hacking/blob/master/_notebooks/2021-06-27-Using-Fastai-For-tabular-playground-series-jun-2021.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/reddi-hacking/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#Setup-fastai-and-Google-drive">Setup fastai and Google drive </a></li>
<li class="toc-entry toc-h2"><a href="#Environment-Setup">Environment Setup </a></li>
<li class="toc-entry toc-h2"><a href="#Setup-kaggle-environment-parameters">Setup kaggle environment parameters </a></li>
<li class="toc-entry toc-h2"><a href="#Exploring-the-Playground-data">Exploring the Playground data </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Set-the-y-column-type">Set the y column type </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#First-things-first">First things first </a></li>
<li class="toc-entry toc-h2"><a href="#Goal:-Better-model-training,-refining-fastai-parameters,-using-EDA-insights-gathered-to-date">Goal: Better model training, refining fastai parameters, using EDA insights gathered to date </a></li>
<li class="toc-entry toc-h2"><a href="#EDA-on-the-categorical-and-continuous-feature-splits">EDA on the categorical and continuous feature splits </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Prep-the-learner">Prep the learner </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Submission-To-Kaggle">Submission To Kaggle </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-06-27-Using-Fastai-For-tabular-playground-series-jun-2021.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h2>
<p>This is a modification of the <a href="https://redditech.github.io/team-fast-tabulous/kaggle/fastai/2021/06/25/_First_Pass_Using_Fastai_For_Homesite_Competition.html">"first pass" submission</a> to the Homesite Competition on Kaggle Competition using Google Colab, but modifying some of the default parameters and maybe adding some learning from the <a href="https://redditech.github.io/team-fast-tabulous/kaggle/2021/06/23/Exploring-Homesite_Data.html">initial exploratory data analysis</a> on other projects to apply to this one, to see if I can applying what was learnt so far to see how it fairs in a submission.</p>
<p>Changes made:</p>
<ul>
<li>Use TestTrainSplitter() for making test and validation sets more fairly weighted based on the bias of any input data towards negative results</li>
<li>Increase batch size to 1024 to make training shorter, but to still hopefully get a better predictor for it. Set a separate validator batch size to 128.</li>
<li>Increase the validation percentage to 0.25</li>
<li>Fix the learning rate to 1e-3</li>
<li>Increase epochs to 5</li>
<li>Modified the <code>cat_names</code> and <code>cont_names</code> arrays with any initial EDA insights</li>
<li>Add a date part for dates</li>
<li>Add weight decay of 0.2</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-fastai-and-Google-drive">
<a class="anchor" href="#Setup-fastai-and-Google-drive" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup fastai and Google drive<a class="anchor-link" href="#Setup-fastai-and-Google-drive"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install -Uqq fastai
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install kaggle
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: kaggle in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (1.5.12)
Requirement already satisfied: python-dateutil in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (2.8.1)
Requirement already satisfied: six&gt;=1.10 in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (1.16.0)
Requirement already satisfied: tqdm in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (4.61.1)
Requirement already satisfied: urllib3 in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (1.26.4)
Requirement already satisfied: python-slugify in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (5.0.2)
Requirement already satisfied: certifi in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (2021.5.30)
Requirement already satisfied: requests in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from kaggle) (2.25.1)
Requirement already satisfied: text-unidecode&gt;=1.3 in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from python-slugify-&gt;kaggle) (1.3)
Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from requests-&gt;kaggle) (4.0.0)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /home/nissan/miniconda3/envs/fastai/lib/python3.9/site-packages (from requests-&gt;kaggle) (2.10)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Useful links here:</p>
<ul>
<li>Documentation on <a href="https://docs.python.org/3/library/pathlib.html#basic-use">Path library</a>
</li>
<li>Documentation on <a href="https://fastcore.fast.ai/xtras.html#Extensions-to-Pathlib.Path">fastai extensions to Path library</a>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Environment-Setup">
<a class="anchor" href="#Environment-Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Environment Setup<a class="anchor-link" href="#Environment-Setup"> </a>
</h2>
<blockquote>
<p>Setup the environment variables here (these will change as we play around to get the best model for submission)</p>
<ul>
<li>Set the random seed so that the results are reproducible</li>
<li>Set the batch size for training</li>
<li>Set the batch size for validation</li>
<li>Set what portion of training data to set aside for validation</li>
<li>Set the number of epochs of training to run to not overfit</li>
<li>Set the learning rate to be used</li>
<li>Set the weight decay</li>
</ul>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> 
<span class="n">bs</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">val_bs</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">wd</span><span class="o">=</span><span class="mf">0.2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup-kaggle-environment-parameters">
<a class="anchor" href="#Setup-kaggle-environment-parameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup kaggle environment parameters<a class="anchor-link" href="#Setup-kaggle-environment-parameters"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kaggle</span> <span class="kn">import</span> <span class="n">api</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
<span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#10) [Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/.gitignore'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/.ipynb_checkpoints'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/2021-06-21-Getting-Data-In-Kaggle.ipynb'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/2021-06-27-Using-Fastai-For-tabular-playground-series-jun-2021.ipynb'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/2021_06_23_Messing_around_with_fastai.ipynb'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/ghtop_images'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/my_icons'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/README.md'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/Untitled.ipynb'),Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/_data')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>This bit is to make sure I don't checkin my data to Github when I'm finished</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>touch .gitignore
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span><span class="nb">echo</span> <span class="s2">"_data"</span> &gt; .gitignore
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head .gitignore
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>_data
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>mkdir _data
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mkdir: cannot create directory ‘_data’: File exists
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">'_data'</span><span class="p">)</span>
<span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('/mnt/d/Code/GitHub/reddi-hacking/_notebooks/_data')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="s2">"playground_Jun_2021_data"</span>
<span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
<span class="n">api</span><span class="o">.</span><span class="n">competition_download_cli</span><span class="p">(</span><span class="s1">'tabular-playground-series-jun-2021'</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tabular-playground-series-jun-2021.zip: Skipping, found more recently modified local copy (use --force to force download)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [Path('sample_submission.csv'),Path('submission8.csv'),Path('tabular-playground-series-jun-2021.zip'),Path('test.csv'),Path('train.csv')]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file_extract</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"tabular-playground-series-jun-2021.zip"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#5) [Path('sample_submission.csv'),Path('submission8.csv'),Path('tabular-playground-series-jun-2021.zip'),Path('test.csv'),Path('train.csv')]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploring-the-Playground-data">
<a class="anchor" href="#Exploring-the-Playground-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploring the Playground data<a class="anchor-link" href="#Exploring-the-Playground-data"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"train.csv"</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>...</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Class_2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>Class_8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Class_2</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 77 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(200000, 77)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>...</th>
      <th>feature_65</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.00000</td>
      <td>...</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.000000</td>
      <td>200000.00000</td>
      <td>200000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>99999.500000</td>
      <td>0.972710</td>
      <td>1.168365</td>
      <td>2.219325</td>
      <td>2.296735</td>
      <td>0.793530</td>
      <td>1.431105</td>
      <td>1.010695</td>
      <td>0.673090</td>
      <td>1.94398</td>
      <td>...</td>
      <td>1.798040</td>
      <td>0.508695</td>
      <td>1.827300</td>
      <td>0.910370</td>
      <td>1.603585</td>
      <td>1.219210</td>
      <td>0.806895</td>
      <td>1.282925</td>
      <td>2.94021</td>
      <td>0.632005</td>
    </tr>
    <tr>
      <th>std</th>
      <td>57735.171256</td>
      <td>3.941836</td>
      <td>3.993407</td>
      <td>6.476570</td>
      <td>7.551858</td>
      <td>2.935785</td>
      <td>5.162746</td>
      <td>3.949231</td>
      <td>2.234949</td>
      <td>3.93133</td>
      <td>...</td>
      <td>5.053014</td>
      <td>1.867330</td>
      <td>7.188924</td>
      <td>3.835182</td>
      <td>4.877679</td>
      <td>4.826003</td>
      <td>2.458741</td>
      <td>4.261420</td>
      <td>10.78465</td>
      <td>3.925310</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>49999.750000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>99999.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>149999.250000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.00000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>199999.000000</td>
      <td>61.000000</td>
      <td>51.000000</td>
      <td>64.000000</td>
      <td>70.000000</td>
      <td>38.000000</td>
      <td>76.000000</td>
      <td>43.000000</td>
      <td>30.000000</td>
      <td>38.00000</td>
      <td>...</td>
      <td>54.000000</td>
      <td>24.000000</td>
      <td>79.000000</td>
      <td>55.000000</td>
      <td>65.000000</td>
      <td>67.000000</td>
      <td>30.000000</td>
      <td>61.000000</td>
      <td>130.00000</td>
      <td>52.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 76 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kc">True</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"test.csv"</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>...</th>
      <th>feature_65</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200001</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200002</td>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200003</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200004</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(100000, 76)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kc">True</span> <span class="ow">in</span> <span class="n">df_test</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_column</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_column</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index(['target'], dtype='object')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this it looks like <code>target</code> is the value we want to predict. Let's take a look at this</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>pandas.core.series.Series</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array(['Class_6', 'Class_2', 'Class_8', 'Class_3', 'Class_1', 'Class_5',
       'Class_7', 'Class_9', 'Class_4'], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>str</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Set-the-y-column-type">
<a class="anchor" href="#Set-the-y-column-type" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set the y column type<a class="anchor-link" href="#Set-the-y-column-type"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make this a category for the purpose of generating predictions as a classification</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'category'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target_categories</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">target_categories</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['Class_6', 'Class_2', 'Class_8', 'Class_3', 'Class_1', 'Class_5', 'Class_7', 'Class_9', 'Class_4']
Categories (9, object): ['Class_6', 'Class_2', 'Class_8', 'Class_3', ..., 'Class_5', 'Class_7', 'Class_9', 'Class_4']</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">target_categories</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how the training data outcomes are balanced</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>count      200000
unique          9
top       Class_6
freq        51811
Name: target, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data_balance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s2">"target"</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"target"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data_balance</span><span class="p">[</span><span class="s2">"target"</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Class_6</th>
      <td>51811</td>
      <td>1</td>
      <td>Class_6</td>
      <td>51811</td>
    </tr>
    <tr>
      <th>Class_2</th>
      <td>24431</td>
      <td>1</td>
      <td>Class_2</td>
      <td>24431</td>
    </tr>
    <tr>
      <th>Class_8</th>
      <td>51763</td>
      <td>1</td>
      <td>Class_8</td>
      <td>51763</td>
    </tr>
    <tr>
      <th>Class_3</th>
      <td>14798</td>
      <td>1</td>
      <td>Class_3</td>
      <td>14798</td>
    </tr>
    <tr>
      <th>Class_1</th>
      <td>9118</td>
      <td>1</td>
      <td>Class_1</td>
      <td>9118</td>
    </tr>
    <tr>
      <th>Class_5</th>
      <td>3064</td>
      <td>1</td>
      <td>Class_5</td>
      <td>3064</td>
    </tr>
    <tr>
      <th>Class_7</th>
      <td>14769</td>
      <td>1</td>
      <td>Class_7</td>
      <td>14769</td>
    </tr>
    <tr>
      <th>Class_9</th>
      <td>25542</td>
      <td>1</td>
      <td>Class_9</td>
      <td>25542</td>
    </tr>
    <tr>
      <th>Class_4</th>
      <td>4704</td>
      <td>1</td>
      <td>Class_4</td>
      <td>4704</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's not quite equally weighted, e.g. <code>Class_4</code> and <code>Class_5</code> are ten times less than <code>Class_6</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="First-things-first">
<a class="anchor" href="#First-things-first" aria-hidden="true"><span class="octicon octicon-link"></span></a>First things first<a class="anchor-link" href="#First-things-first"> </a>
</h2>
<ul>
<li>
<code>id</code> looks unique so we can test this and if true, make it the index</li>
</ul>
<p>Additionally, we should make sure to apply any changes to data types to both train and test data so predictions don't fail later on</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">df_test</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0         1
 111331    1
 49869     1
 56014     1
 53967     1
          ..
 183667    1
 193908    1
 195957    1
 189814    1
 2047      1
 Name: id, Length: 200000, dtype: int64,
 262144    1
 269609    1
 206158    1
 212301    1
 210252    1
          ..
 283295    1
 285342    1
 279197    1
 281244    1
 264191    1
 Name: id, Length: 100000, dtype: int64)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goal:-Better-model-training,-refining-fastai-parameters,-using-EDA-insights-gathered-to-date">
<a class="anchor" href="#Goal:-Better-model-training,-refining-fastai-parameters,-using-EDA-insights-gathered-to-date" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goal: Better model training, refining fastai parameters, using EDA insights gathered to date<a class="anchor-link" href="#Goal:-Better-model-training,-refining-fastai-parameters,-using-EDA-insights-gathered-to-date"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_column</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">y_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['target']</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span> <span class="o">=</span> <span class="n">cont_cat_split</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">dep_var</span><span class="o">=</span><span class="n">y_names</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">cont_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(72, 3)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="EDA-on-the-categorical-and-continuous-feature-splits">
<a class="anchor" href="#EDA-on-the-categorical-and-continuous-feature-splits" aria-hidden="true"><span class="octicon octicon-link"></span></a>EDA on the categorical and continuous feature splits<a class="anchor-link" href="#EDA-on-the-categorical-and-continuous-feature-splits"> </a>
</h2>
<blockquote>
<p>Functions to improve fastai's <code>cont_cat_split</code> choices</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal here is to validate the splot, rearrange as needed, and explicitly set the dtype and categories for categorical columns. I am going to use what I wrote for <a href="https://redditech.github.io/team-fast-tabulous/kaggle/fastai/2021/06/27/Improving-Fastai-split-choices.html#New-Work---A-function-to-improve-fastai's-cont_cat_split-choices">another post</a> with some functions that help speed up evaluating the splits and reassigning them better than the fastai defaults</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First I'll create a <code>triage</code> list for any fields that can't be programmatically optimized. These are the ones we have to do manual steps for until I find a way to do better</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">triage</span> <span class="o">=</span> <span class="n">L</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a quick look at the descriptions of the categorical and continuous splits automatically done</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="n">cont_names</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>feature_9</th>
      <th>...</th>
      <th>feature_65</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>...</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>42</td>
      <td>37</td>
      <td>48</td>
      <td>59</td>
      <td>30</td>
      <td>55</td>
      <td>40</td>
      <td>26</td>
      <td>28</td>
      <td>51</td>
      <td>...</td>
      <td>41</td>
      <td>23</td>
      <td>57</td>
      <td>42</td>
      <td>52</td>
      <td>49</td>
      <td>31</td>
      <td>37</td>
      <td>91</td>
      <td>50</td>
    </tr>
    <tr>
      <th>top</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>146389</td>
      <td>140375</td>
      <td>122501</td>
      <td>120767</td>
      <td>154093</td>
      <td>119020</td>
      <td>150969</td>
      <td>150350</td>
      <td>117000</td>
      <td>124466</td>
      <td>...</td>
      <td>124517</td>
      <td>165048</td>
      <td>141642</td>
      <td>145532</td>
      <td>113213</td>
      <td>132247</td>
      <td>139966</td>
      <td>123153</td>
      <td>142555</td>
      <td>169451</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 72 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first thing I notice, is that for a number of these fields, there is quite a low number of <code>unique</code> values. Luckily, I don't see any missing or NA values as all the <code>count</code> totals are equal to the total number of rows of data. These are a lot of fields to go through and manually recategorize and then get their categories, but I am hoping I can do this programmatically.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's have a look at the existing categoricals to make sure there's nothing suspeicious about these here either</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="n">cat_names</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'object'</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_17</th>
      <th>feature_26</th>
      <th>feature_30</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>200000</td>
      <td>200000</td>
      <td>200000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>15</td>
      <td>20</td>
      <td>18</td>
    </tr>
    <tr>
      <th>top</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>169538</td>
      <td>127772</td>
      <td>134843</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here I define two functions, which will help</p>
<ul>
<li>to reset the <code>cont_names</code> and <code>cat_names</code> arrays with better fits of the actual data fields for those that are categorical, but were put into the continuous array. </li>
<li>For all cateogorical fields, it will also setup the categories for these fields and change their dtype </li>
<li>For any fields that have null values, it will remove them from their respective field, and place them in the <code>triage</code> list</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">reassign_to_categorical</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">continuous</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">triage</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">field_categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'category'</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">field_categories</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">continuous</span><span class="p">:</span> <span class="n">continuous</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical</span><span class="p">:</span> <span class="n">categorical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">continuous</span><span class="p">:</span> <span class="n">continuous</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">categorical</span><span class="p">:</span> <span class="n">categorical</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="n">triage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">continuous</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">triage</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">categorize</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">triage</span><span class="p">,</span> <span class="n">category_threshold</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="n">category_threshold</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">)):</span>
      <span class="n">reassign_to_categorical</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">triage</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">triage</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">triage</span> <span class="o">=</span> <span class="n">categorize</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">cont_names</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">,</span> <span class="n">triage</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cont_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, 74)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So this is a big rebalancing between continuous and categorical fields. I saved alot of time with this function rather than doing this manually like I had for my initial data exploration. Let's take a look at how many came up for triaging still though</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">triage</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#0) []</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This was expected, since my triage fields would only be those that have NA values,so that we can look closer at the data to evaluate a FillMissing strategy, or if we have too many missing data values, to ignore the field in modelling</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Prep-the-learner">
<a class="anchor" href="#Prep-the-learner" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prep the learner<a class="anchor-link" href="#Prep-the-learner"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>Check to make sure I didn't make any typos, if the counts show any missing rows that's a sign</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">'all'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>feature_9</th>
      <th>...</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>...</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000.0</td>
      <td>200000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>42.0</td>
      <td>37.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>30.0</td>
      <td>55.0</td>
      <td>40.0</td>
      <td>26.0</td>
      <td>28.0</td>
      <td>51.0</td>
      <td>...</td>
      <td>23.0</td>
      <td>57.0</td>
      <td>42.0</td>
      <td>52.0</td>
      <td>49.0</td>
      <td>31.0</td>
      <td>37.0</td>
      <td>91.0</td>
      <td>50.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>top</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>146389.0</td>
      <td>140375.0</td>
      <td>122501.0</td>
      <td>120767.0</td>
      <td>154093.0</td>
      <td>119020.0</td>
      <td>150969.0</td>
      <td>150350.0</td>
      <td>117000.0</td>
      <td>124466.0</td>
      <td>...</td>
      <td>165048.0</td>
      <td>141642.0</td>
      <td>145532.0</td>
      <td>113213.0</td>
      <td>132247.0</td>
      <td>139966.0</td>
      <td>123153.0</td>
      <td>142555.0</td>
      <td>169451.0</td>
      <td>51811</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 76 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kc">True</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s2">"id"</span> <span class="ow">in</span> <span class="n">cont_names</span><span class="p">,</span> <span class="s2">"id"</span> <span class="ow">in</span> <span class="n">cat_names</span> <span class="c1">#Make sure we've gotten our y-column excluded</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(False, False)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">TrainTestSplitter</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="n">y_names</span><span class="p">])(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df_train</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span> <span class="n">y_names</span><span class="o">=</span><span class="n">y_names</span><span class="p">,</span><span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">val_bs</span><span class="o">=</span><span class="n">val_bs</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span> <span class="n">ps</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.001</span><span class="p">])</span>
<span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_17</th>
      <th>feature_26</th>
      <th>feature_30</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>feature_3</th>
      <th>feature_4</th>
      <th>feature_5</th>
      <th>feature_6</th>
      <th>feature_7</th>
      <th>feature_8</th>
      <th>feature_9</th>
      <th>feature_10</th>
      <th>feature_11</th>
      <th>feature_12</th>
      <th>feature_13</th>
      <th>feature_14</th>
      <th>feature_16</th>
      <th>feature_18</th>
      <th>feature_19</th>
      <th>feature_20</th>
      <th>feature_21</th>
      <th>feature_22</th>
      <th>feature_23</th>
      <th>feature_24</th>
      <th>feature_25</th>
      <th>feature_27</th>
      <th>feature_28</th>
      <th>feature_29</th>
      <th>feature_31</th>
      <th>feature_32</th>
      <th>feature_33</th>
      <th>feature_34</th>
      <th>feature_35</th>
      <th>feature_36</th>
      <th>feature_37</th>
      <th>feature_38</th>
      <th>feature_39</th>
      <th>feature_40</th>
      <th>feature_41</th>
      <th>feature_42</th>
      <th>feature_43</th>
      <th>feature_44</th>
      <th>feature_45</th>
      <th>feature_46</th>
      <th>feature_47</th>
      <th>feature_48</th>
      <th>feature_49</th>
      <th>feature_50</th>
      <th>feature_51</th>
      <th>feature_52</th>
      <th>feature_53</th>
      <th>feature_54</th>
      <th>feature_55</th>
      <th>feature_56</th>
      <th>feature_57</th>
      <th>feature_58</th>
      <th>feature_59</th>
      <th>feature_60</th>
      <th>feature_61</th>
      <th>feature_62</th>
      <th>feature_63</th>
      <th>feature_64</th>
      <th>feature_65</th>
      <th>feature_66</th>
      <th>feature_67</th>
      <th>feature_68</th>
      <th>feature_69</th>
      <th>feature_70</th>
      <th>feature_71</th>
      <th>feature_72</th>
      <th>feature_73</th>
      <th>feature_74</th>
      <th>feature_15</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>17</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>4.692236e-08</td>
      <td>Class_2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>32</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>23</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>2</td>
      <td>0</td>
      <td>12</td>
      <td>4</td>
      <td>54</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>3</td>
      <td>13</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>42</td>
      <td>0</td>
      <td>3</td>
      <td>54</td>
      <td>0</td>
      <td>25</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>19</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>10</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>18</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>0</td>
      <td>2.000000e+00</td>
      <td>Class_6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4.692236e-08</td>
      <td>Class_9</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span><span class="o">*</span><span class="n">bs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span><span class="o">*</span><span class="n">val_bs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(149504, 50048)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=tensor(0.0014))</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEKCAYAAAAfGVI8AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAqbUlEQVR4nO3deXxU9b3/8dcnyWQPAZKwyL6IgLIaZROXatVytS5YS0V+1Yq41aX1Wrvd3i63t7e31Vo33Kj2Viqi4la1trYoIIosIgiIbAJhDVsWkklmMt/fHzNBTLNCTmYm834+HnmQzDlnzjvjOJ98z/d7vl9zziEiIokrKdoBREQkulQIREQSnAqBiEiCUyEQEUlwKgQiIglOhUBEJMGlRDtAS+Xn57u+fftGO4aISFxZvnz5PudcQX3b4q4Q9O3bl2XLlkU7hohIXDGzrQ1t06UhEZEEp0IgIpLgVAhERBJc3PUR1CcQCFBUVITf7492lKhJT0+nZ8+e+Hy+aEcRkTjTLgpBUVEROTk59O3bFzOLdpw255xj//79FBUV0a9fv2jHEZE40y4uDfn9fvLy8hKyCACYGXl5eQndIhKRY9cuCgGQsEWgVqL//iLt3Vtr97Bxb5knz91uCkE8yc7OBuCzzz7jlFNOiXIaEYkHN89ewQsrdnjy3IlZCFbNhd+dAj/tGP531dxoJxIRaVBNyFFdEyI9JdmT50+8QrBqLrx6G5RsB1z431dvO65icPfdd/Pwww8f+fmnP/0pP/vZzzj33HMZPXo0w4YN4+WXX270OWpqarjrrrs47bTTGD58OI8++igA06ZN+8KxU6dO5ZVXXjnmrCISf6qDIQDSfN58ZCdeIfjHzyFQ+cXHApXhx4/RlClTePbZZ4/8PHfuXK699lpefPFFVqxYwfz587nzzjtpbFnQWbNmkZuby9KlS1m6dCmPP/44W7ZsYfr06Tz55JMAlJSUsHjxYiZNmnTMWUUk/vgDNQCkp3jzkd0uho+2SElRyx5vhlGjRrF371527txJcXExnTp1onv37nznO99hwYIFJCUlsWPHDvbs2UO3bt3qfY6//e1vrFq1iueffz4cp6SEDRs2cP7553PLLbewd+9e5s2bx+TJk0lJSbz/bCKJrOpIi8CbS0OJ94mS2zNyWaiex4/DFVdcwfPPP8/u3buZMmUKs2fPpri4mOXLl+Pz+ejbt2+jwzudczzwwANccMEF/7Jt2rRpzJ49mzlz5vCHP/zhuHKKSPw50iLQpaFWcu5PwJfxxcd8GeHHj8OUKVOYM2cOzz//PFdccQUlJSV06dIFn8/H/Pnz2bq1wYn/ALjggguYOXMmgUAAgE8//ZTDhw8DcM0113DfffcBcPLJJx9XThGJP/5g7aUhtQhax/Arw//+4+fhy0G5PcNFoPbxY3TyySdTVlZGjx496N69O1OnTuXiiy+msLCQkSNHMnjw4EaPnz59Op999hmjR4/GOUdBQQEvvfQSAF27dmXIkCFceumlx5VRROJTVcDbzmJrrAMzFhUWFrq66xGsW7eOIUOGRCmR9yoqKhg2bBgrVqwgNze3wf3a++sgkqiWbN7P1x97nz9PH8P4gfnH9Bxmttw5V1jftsS7NBRn3nrrLQYPHsytt97aaBEQkfaryuPho4l3aSjOnHfeeWzbti3aMUQkimo7i9N0Q5mISGLyR1oE6R4NH203hSDe+jpaW6L//iLtWdWRFkGcDR81s15mNt/M1pnZGjO7vZ59zjazEjNbGfk6pjGc6enp7N+/P2E/DGvXI0hPT492FBHxgNctAi/7CILAnc65FWaWAyw3s78759bW2W+hc+6i4zlRz549KSoqori4+HieJq7VrlAmIu3PkRZBvHUWO+d2Absi35eZ2TqgB1C3EBw3n8+nlblEpN2qHTUU17OPmllfYBSwpJ7N48zsIzN7w8x026yISB3+QA1JBr5kbxag8nz4qJllAy8AdzjnSutsXgH0cc6Vm9kk4CXgxHqeYwYwA6B3797eBhYRiTFVwRBpKcmerUToaYvAzHyEi8Bs59y8utudc6XOufLI968DPjP7l9vmnHOPOecKnXOFBQUFXkYWEYk5/kCNZxPOgbejhgyYBaxzzt3bwD7dIvthZqdH8uz3KpOISDwKFwJv+gfA20tDE4BpwGozWxl57IdAbwDn3CPAFcBNZhYEKoEpLlHHgIqINCB8aci7FoGXo4YWAY1e0HLOPQg86FUGEZH2wOsWQbu5s1hEpL3yukWgQiAiEuP8gRrPlqkEFQIRkZjnD4R0aUhEJJHp0pCISIKrUmexiEhi8wdq1CIQEUlkVcFQfN5ZLCIircMfqPFs5lFQIRARiXlVwZBnaxGACoGISEwL1oQIhpxaBCIiiap2mUq1CEREElTtMpUaPioikqD8Hi9TCSoEIiIxzeuF60GFQEQkpvkDkT4CtQhERBKTP1jbR6AWgYhIQqpSi0BEJLGpRSAikuDUIhARSXBVahGIiCQ2v24oExFJbFW1U0xoPQIRkcSkFoGISIL7/IYytQhERBJSVbCGlCQjJVmFQEQkIfkDIU8vC4EKgYhITKsKertwPagQiIjENLUIREQSnD+gFoGISEILL1yvFoGISMLyB2o8nV4CVAhERGJaVTCkS0MiIomsKlATv53FZtbLzOab2TozW2Nmtzey72lmVmNmV3iVR0QkHvkDIU8XrgdI8fC5g8CdzrkVZpYDLDezvzvn1h69k5klA78G3vQwi4hIXKoK1ni6cD142CJwzu1yzq2IfF8GrAN61LPrrcALwF6vsoiIxKu2aBG0SR+BmfUFRgFL6jzeA7gMeKQtcoiIxBt/PLcIaplZNuG/+O9wzpXW2XwfcLdzrqaJ55hhZsvMbFlxcbFHSUVEYk9VG9xZ7GUfAWbmI1wEZjvn5tWzSyEwx8wA8oFJZhZ0zr109E7OuceAxwAKCwudl5lFRGKFcw5/sIZ0j4ePelYILPzpPgtY55y7t759nHP9jtr/KeAvdYuAiEiiCtQ4nMPzO4u9bBFMAKYBq81sZeSxHwK9AZxz6hcQEWmEP7Jwvdc3lHlWCJxziwBrwf7XeJVFRCQe1S5TqbmGREQSVFVkmUqv+whUCEREYlRV0PuF60GFQEQkZrXFwvWgQiAiErPUIhARSXBqEYiIJDi1CEREElxti0CFQEQkQVW10Q1lKgQiIjFKLQIRkQRXe2exFq8XEUlQVcHaUUNqEYiIJKQjcw2pj0BEJDH5AyFSk5NISmr2/J3HRIVARCRGtcXC9aBCICISs/xtsEwlqBCIiMSsqmCN5/0D4PGaxfHIOcem4nI6ZaaSl50W7ThtLhRymEFkHekjgjUhDlfVUFIZ4GBFNQcrqqmoriE7LYWc9BQ6ZPgoyEmjQ7ovSslF2p+2WLgeEqgQ+AM1vLlmNxcNP4HkOh0vzjnW7Czl9dW7eOPj3WzZd5is1GTuOG8Q10zoiy+58Yq8t8zPa6t28cbq3eTnpHLjWQMY3rNjs7OFQo7y6iBl/iClkQ/anYf8FB2sYMfBSqprQqSnJJPmSyLJjIMV1ewvr2b/4WqyUpPpX5BFv/xs+uRlkpvhIzsthez0FJLNCIZCBEOOqkCIA4er2VdexYHD4WP3lVexv7yaA4erOVRZTWllkFJ/AOcgNSWJtJQkkpOMiuoaqiPD2JqSk5bCCR0z6JufyZTTenPWoALPO7pE2it/QC2CVvXShzv4/rzVzHx7E3d/ZTBnDyoAYOGGfdz/jw0s23qQ5CRj/IA8vjWhL/PXF/PL19cxd9l27r5wMLmZPsqrghyuCnKoIhD5AK1iU/FhFm/aR8jB4G45fLK7lNdX72biifl8a0I/OmelYgZJZiSZ4Uu2Ix+uH2w5wHub97Nk835K/cF6c3fJSSMjNZmqQIiqYA3BkKNzVip5Wan06JhOqT/IPz8pZl95UYtej3RfEnlZaeRnp5KXncqAgixyM3x0yPCRZEZVMHy+mpAjIzWZ7NQUMlKTyc3w0SkzlU5ZPjJTU6ioDlJaGaSkMsDeMj87D/nZcaiSD7cd4s01exjYJZvrzujHqX06EagJEahxGFCQk0ZBTlqTRVYkkVUF26ZFYM45z0/SmgoLC92yZctafFwo5Hht9S5+8+Z6th2oYFz/PCoCNXy0/RDdc9O54cz+XDKyB52yUo8c89baPfz01TUUHays9zk7pKfQLTedLw/tyqUje3Bi1xzK/AGefn8bsxZtZl95dZO5enfOZFz/PAZ2yaZDRgo56T5yM3z06JhB947pzb6RpKQyQNHBCsr9QQ5HWhch50hOSiIlyUhNTqJzdir5WWnkZaeSlebt3wDVwRCvr97F4ws3s2ZnaYP75WenMrBLNqN7d+LUPp0Y1bsTnY/6byCSyK6YuZg0XxKzp4897ucys+XOucJ6tyVKIahVHQzx5yVbuf+fG8nwJXPLOQOZfGqPBj9w/YEaFm/ahy85iay0FLLTUo78VZzaSJPNHwj/xR+oCeEchJwj5ByBGkcwFCI5KYnRvTvSs1PmMf8u8cA5x4ptB9lV4iclKYnUFCMUguLyKvaU+tld4mftrlLW7iwlGAq/F7vkpHFStxxO6prD6f06c+aggjb5q0gk1lz8wCIKctL4wzWnHfdzqRDUo/b3rtspKtFRWV3DqqJDfFR0iPW7y1m/p5QNe8qpCobISk3mS0O6cuHJ3Ti9X2cKchKvE18S05fvfYcTu2bz8NRTj/u5GisECdNHUJcKQGzJSE1mTP88xvTPO/JYoCbEe5v288bHu3hzzR5e/WgnAH3yMjm1dyfGDsjjrEEFdO2QHq3YIp7yB2s8n2cIErgQSOzzJSdx5qACzhxUwC8uCfFRUQnLtx5g+daDLNhQzLwPdwAwpHsHzhpUwFmDCji1T6dGL9mJxJPw8FGNGhIBICU5iVP7hDuUIXxpb92uMt75tJi31+/liYWbeeSdTWSlJjN+YD5fOaUbXzmlOxmp6luQ+BUePqoWgUi9zIyhJ3Rg6AkduOnsAZT5AyzetJ93Pi3mnfXF/H3tHn7y8houHnECXz+tFyN7dYx2ZJEW8wdDbTLXkAqBtAs56T4uOLkbF5zcDeccH2w5wNxlRbz04Q6e+WAbE0/M57tfHsSo3p2iHVWkWZxzVAfDN5N6rVmlxsyyzCwp8v0gM/uqmWkuAYlJZsaY/nncc+UIPvjRufxw0mDW7CzlsocX862nlrK2kfsaRGJF7aI0sTTp3AIg3cx6AP8ArgWe8iqUSGvJSfcx48wBLPjeOdx1wUks33qQf3tgIf/+3EfsKqn/RkGRWFAVqF2dLHamoTbnXAVwOfCAc+4yYKh3sURaV3ZaCrecM5AFd53D9RP788rKnZzz27e552/rqayuiXY8kX/hD9auVxw7LQIzs3HAVOC1yGPqX5C4k5vp44eThvCPO8/i/KHdeOCfG7ngvgUs2rAv2tFEvqCtlqmE5heCO4AfAC8659aYWX9gvmepRDzWq3Mm939jFM9cP5bkJOPqWUu4c+5HHDzc9PxQIm0h5voInHPvOOe+6pz7daTTeJ9z7jaPs4l4btyAPN64fSK3nDOAl1fu4Jx73uZP72+lJhRfU69I+1PbImiLG8qaO2roz2bWwcyygLXAejO7q4ljepnZfDNbZ2ZrzOz2eva5xMxWmdlKM1tmZmcc268hcuzSfcncdcFgXrttIoO75fAfL33MxQ8sYtlnB6IdTRJYbYugLW4oa26pGeqcKwUuBV4HegPTmjgmCNzpnBsCjAVuMbO6Hcz/AEY450YC3wKeaGYekVZ3Urccnrl+LA9eNYqDFdVc8ch7/PtzH7G/vCra0SQBxVyLAPBF7hu4FHjZORcAGm07O+d2OedWRL4vA9YBPersU+4+n/40q6nnFPGamXHR8BN467tncdPZA3jpwx186Z53mL1kKyFdLpI25A/EXovgUeAzwh/WC8ysD9Dsu3LMrC8wClhSz7bLzOwTwqORvtXA8TMil46WFRcXN/e0IscsKy2Fuy8czBu3T2RI9xx+9OLHTHn8fXaX+KMdTRJEVTDGWgTOufudcz2cc5Nc2FbgnOYca2bZwAvAHZHLS3Wf+0Xn3GDCrY1fNHD+x5xzhc65woKCguacVqRVnNg1fLnof68Yzsc7Sph0/0Lmf7I32rEkAdS2CGJm1JCZ5ZrZvbV/lZvZPYRbB00d5yNcBGY75+Y1tq9zbgEwwMzym5NJpK2YGVcW9uKVb59Bl5w0rn1qKf/9+rojf7GJeKH2/RVL9xH8ASgDrox8lQJPNnaAhVd+mQWsc87d28A+AyP7YWajgVRgfzMzibSpgV2yeemWCVw9tjePLdjMJQ++q3mLxDNH+ghipUUADHDO/adzbnPk62dA/yaOmUB4ZNGXIsNDV5rZJDO70cxujOwzGfjYzFYCDwFfP6rzWCTmpPuS+a9LhzHrm4XsP1zNJQ8t4qH5GwnWhKIdTdqZthw11NxpIirN7Azn3CIAM5sANDpjV2TfRteDdM79Gvh1MzOIxIxzh3Tlb3d04j9e/pjfvLmedzfuY+bVp5KboUl5pXWU+gOkpiTF1KihG4GHzOwzM/sMeBC4wbNUInGgU1YqD141mt9cMZylnx1g8szFbD9QEe1Y0k6U+YN0SG+bPyyaO2roI+fcCGA4MNw5Nwr4kqfJROLE1wp78X/fGsPeUj+XPfwuK7cfinYkaQdKKwN0SG+buT1bdPHJOVd61BDQ73qQRyQujRuQx7ybx5ORmsyUx97jrx/vjnYkiXNl/iA5bXSp8Xh6IRq9/i+SaAZ2yeHFmycwpHsHbpq9nMcXbEZjH+RYlfpjtEVQh97hInXkZ6fxzPVjmXRKd375+jp+/NLHGlEkx6TMHySnjQpBo2cxszLq/8A3IMOTRCJxLt2XzAPfGEXvvExmvr2JXSV+HrpqNBmp3o/+kPYj3EcQA5eGnHM5zrkO9XzlOOe0QplIA5KSjLsvHMwvLzuF+ev3cvWsJZRUBKIdS+JIW7YIvL9TQSSBTR3Th4euGs3qohKufPQ9TVonzRKoCVEZqImNFoGIHL9Jw7rz5LWnUXSwgskzF7Nxb3m0I0mMK/MHAdQiEGlPJgzMZ86McVQFa5g8czEfbNHqZ9Kw0srwZcQOcTB8VERaYFjPXF68eQJ52alcPWsJf1m1M9qRJEZ93iJQIRBpd3p1zuSFG8czomcu3/7zhzz6zibdayD/otQfaRHo0pBI+9QpK5U/XTeGi4Z351dvfML3X1hNdVD3GsjnyiKFoK1aBBoCKhIF6b5k7p8yin75WTzwz41sO1DBzKtH0zEzNdrRJAaUVoYvDXXIUItApF1LSjLuPP8k7r1yBMu3HuTyhxfz2b7D0Y4lMaC0jVsEKgQiUXb56J48PX0MByuquezhd1n2mUYUJbrSSGdxdppaBCIJ4/R+nZl38wQ6ZqZy1RNLePUjjShKZGX+ADlpKSQntc3cnioEIjGiX34W824Kjyi69ZkPue+tTwmFNKIoEbXl9BKgQiASUzplpfL09DFcProH9721gW/9cSmHKqqjHUvaWGlloM1uJgMVApGYk5aSzD1fG8EvLj2Fdzfu46IHFvHxjpJox5I2pBaBiGBmTBvbh7k3jCMUclw+czGPL9hMjS4VJYTwojRqEYgIMKp3J/5y20TOHlTAL19fxzcef5/tByqiHUs8phaBiHxB56xUHp12Kvd8bQTrdpZy4X0LNE9RO1fqb9s+At1ZLBIHzIzJp/Zk7IA8bn/mQ2595kPyNr/MuC0PQUkR5PaEc38Cw6+MdlQ5Ts45tQhEpGE9Ombw9PQxfK/7KkZ8+BMo2Q648L+v3gar5kY7ohyniuoaakJOfQQi0rB0XzI31jxNptUZVhqohH/8PDqhpNW09RTUoEIgEpesZEf9G0qK2jaItLrP5xnSpSERaUxuz3ofdg08LvGjdgpq3VAmIo079yfgy/jCQxUulZfzrtNCN3GudgpqtQhEpHHDr4SL74fcXoDhcnvxet8fcMfaQXz/hdX4AzXRTijH6PPVyTR8VESaMvzKI8NFDZjsHNv+/in3/3Mja3eV8vDU0fTqnBndjNJitVNQt9UylaAWgUi7YWZ89/yTePz/FfLZ/sNc/OAi3l6/N9qxpIXURyAix+3LQ7vy6rfPoFuHdK55cim3zF7B1v1a+SxelFYG8SUbaSlt9/Hs2ZnMrJeZzTezdWa2xsxur2efqWa2KvK12MxGeJVHJJH0zc/ixZsncPu5J/LPT/Zy3r3v8PNX11JSEYh2NGlCWWTCObO2WZQGvG0RBIE7nXNDgLHALWY2tM4+W4CznHPDgV8Aj3mYRyShZKQm850vD+Ltu85m8uiePLV4C5PuX8jqIk1pHctK23h6CfCwEDjndjnnVkS+LwPWAT3q7LPYOXcw8uP7gAZBi7Syrh3S+Z/Jw5l38wQAJs9czDMfbNMw0xhV1sYTzkEb9RGYWV9gFLCkkd2uA95o4PgZZrbMzJYVFxd7kFCk/RvZqyOv3noGY/p35gfzVvO951dRFdQw01hTWhloPy2CWmaWDbwA3OGcK21gn3MIF4K769vunHvMOVfonCssKCjwLqxIO9c5K5Wnrj2dW780kOeWFzHtiQ84eFhLYcaSMn+QnLR21CIwMx/hIjDbOTevgX2GA08Alzjn9nuZR0QgOcm48/yTuP8bo1hZdIjLZy5myz6NKooV4bUI2kmLwMJd3rOAdc65exvYpzcwD5jmnPvUqywi8q++OuIEnrl+DCWVAS57+F0WbdgX7UhC7epk7adFMAGYBnzJzFZGviaZ2Y1mdmNkn58AecDDke3LPMwjInWc2qczL948nvzsNK6etYQfv7Saw1XBaMdKWIGaEBXVNW06vQR4OMWEc24R4TvfG9tnOjDdqwwi0rQ+eVn85dYz+O2b65n17hbeXl/M/04ezviB+dGOlnDK/W0/4RzozmIRIbzYzY8vGspzN4zDl5zEVU8s4bdvridYE4p2tIRSuyhNuxw+KiLxobBvZ16/bSJfL+zFg/M3cvWsJewt80c7VsKIxqI0oEIgInVkpCbz6yuG89uvjWDl9kNM+v0idSS3kWhMQQ0qBCLSgCtO7cnLt5xBx0yfOpLbSDQWpQEVAhFpxEndcvjLrWcw/Yx+zF6yjQt/v4D3N+t2H6/UTkGdqz4CEYkltR3Jz84YR5IZ33j8fX7/1gZCIc1V1NpKNWpIRGLZ6f0688btE7lsZA9+99anXPPUUg5oeopWVdsiyE5TIRCRGJWZmsI9V47gvy8bxvub9nPR/QtZse1g0wdKs5RWBslKTSYluW0/mlUIRKRFzIyrxvTmhZvGk5RkXPnIezz6ziZdKmoFZf5Am08vASoEInKMhvXM5bXbJnLekK786o1P+NYfl7K/vCraseJaNCacAxUCETkOuRk+Zl49ml9ccjKLN+5n0v0LWbn9ULRjxa1oTDgHKgQicpzMjGnj+jLv5vH4kpP4+qPv8fLKHdGOFZdK/QE6tPGIIVAhEJFWckqPXF6+ZQIjenbk9jkr+c2bn6jfoIXUIhCRuJeXncbT08cw5bRePDR/E9988gN2l2iuouYqrVQfgYi0A6kpSfzq8mH892XDWPbZQc7/3Tu8vHIHzql10JhSf4CSygD52Wltfm4VAhFpdbVDTN+4fSIDu2Rz+5yVfPuZD6mo1lxFDVmy+QAhB2P65bX5uVUIRMQzffOzeO7G8dx1wUm8sXoX33jsffZpiGm93t24j3RfEqP7dGzzc6sQiIinkpOMW84ZyKPTClm/p4zJMxfz2b7D0Y4VcxZt3Mfp/fJIS0lu83OrEIhIm/jy0K7Mnj6W0soAk2cuZlXRoWhHihm7S/xs3FvOGQPb/rIQqBCISBs6tU8nnr9pPOm+ZKY+sUQ3n0W8uzG88M+EKK0TrUIgIm1qQEE2c28cR8dMH9OeWMKHmrSOdzfto3NWKkO6dYjK+VUIRKTN9eiYwbMzxtE5O5Vpsz5I6BlMnXO8u3Ef4wfkkZRkUcmgQiAiUXFCxwzmzBhLfnYq055Ywhurd0U7UlRsKi5nT2kVZ0TpshCoEIhIFHXPzeDZG8ZxYtccbpq9gl++tpZATSjasdrUog3R7R8AFQIRibKuHdKZe8M4vjmuD48v3MLUx5ewtyxxpqVYtHE/ffIy6dU5M2oZVAhEJOpSU5L42SWncN/XR7J6RwmXPbSYTcXl0Y7luWBNiPc3749qawBUCEQkhlw6qgdzbxhHVbCGyTMXs3xr++5E/qiohPKqYFT7B0CFQERizLCeubxw03hyM3xMfeJ93lq7J9qRPPP2+r0kGYzrH50byWqpEIhIzOmTl8ULN41nUNccZvxpGTPf3tTuZi91zvHyyp2MH5BPp6zUqGZRIRCRmJSfncacGWP5yrDu/Pqvn3Dz7BWUV7Wf2UtXbDvEtgMVXDLyhGhHUSEQkdiVmZrCg98YxQ8nDebNNbu59KF32dxOOpFfXrmDtJQkLjylW7SjqBCISGwzM2acOYCnrxvD/vKqdtGJHKgJ8ZdVuzhvSNeoLE1ZlwqBiMSF8QPzefHmCXTI8HHV4+/ztzW7ox3pmC3asI8Dh6u5dFSPaEcBPCwEZtbLzOab2TozW2Nmt9ezz2Aze8/Mqszs373KIiLtQ9/8cCfy4G453Pj0cv70/tZoRzomL364g46ZPs4aVBDtKIC3LYIgcKdzbggwFrjFzIbW2ecAcBvwWw9ziEg7kp+dxjMzxnLOSV34j5c+5pevraUmFD8jig5XBfn72j1MGtad1JTYuCjjWQrn3C7n3IrI92XAOqBHnX32OueWAgGvcohI+5OZmsKj0049Mi3FDX9azuE4GVH0t7W7qQzUcOnI2LgsBG3UR2BmfYFRwJJjPH6GmS0zs2XFxcWtmk1E4lNKcnhaip9ePJR/frKHrz3yHjsPVUY7VpNe+nAnPTpmUNinU7SjHOF5ITCzbOAF4A7nXOmxPIdz7jHnXKFzrrCgIDauqYlIbLhmQj9mffM0tu4/zFd+v5C/fhy701nvKfWzaOM+Lhl5QtTWHqiPp4XAzHyEi8Bs59w8L88lIonrnMFdePXWM+jdOZMbn17B919YRUV17F0qem7ZdmpCjisLe0U7yhd4OWrIgFnAOufcvV6dR0QEoH9BNi/cNJ6bzh7As8u2c9H9i1hVdCjasY4IhRzPLtvOuP559M3PinacL/CyRTABmAZ8ycxWRr4mmdmNZnYjgJl1M7Mi4LvAj82syMyis2iniMS91JQk7r5wMH+ePpbKQA2XP7yYh+ZvjIlRRYs37Wf7gUqmnB5brQGAFK+e2Dm3CGj0IphzbjfQ06sMIpKYxg3I46+3n8mPXlrNb95czzvri7nnyhFRXfxlztJtdMz0ccHJ0Z9Soq7YGMQqItLKcjN9PPCNUdx75QjW7irlK79fyNxl26Myi+mBw9X8bc0eLhvVg3RfcpufvykqBCLSbpkZl4/uyRu3T2ToCR343vOruP7/llNcVtWmOeatKKK6JsSU03q36Xmby7NLQyIisaJX50zmXD+WP7y7hf99cz3n/PZtJgzM44wTCzjzxHz65HnXeeucY87S7Yzq3ZGTuuV4dp7joUIgIgkhKcmYPrE/Zw0qYNaiLSzcsI8314RXPxvTrzPf/8pgRvVu/Zu8lm09yMa95fx68rBWf+7WYvG26k9hYaFbtmxZtGOISJxzzrFl32HeWreHxxZsZl95NZOGdeM75w1iYJdswiPgj8/eMj+TZy6moqqGBd87h6y06P3tbWbLnXOF9W1Ti0BEEpKZ0b8gmxkF2Vw1pg+PL9jM4ws38/rq3XTK9DH0hA4M7d6B80/uRmGfTi0uDGX+ANf8YSn7yqp5ZsbYqBaBpqhFICISUVxWxRsf72LtzlLW7Srlk91lVAVDjOrdkRvO7M+Xh3YjOTI1hHOOnSV+VheVsGZnCQcOVzNuQB4TTywg3ZfEtU8u5YMtB3jim4WcfVKXKP9mjbcIVAhERBpQWV3Dc8u388TCLWw7UEHHTB8pSUZ1MERV5AsgOcnI8CVTXhUkOck4oWM62w9U8ruvj+CyUbFxq5QuDYmIHIOM1GT+37i+TB3Th79+vJuFG4pJTjJ8yUn4ko3enTM5pUcuQ7p3ICXJWLn9EPPX72XRhn1cN6FfzBSBpqhFICKSABprEeiGMhGRBKdCICKS4FQIREQSnAqBiEiCUyEQEUlwKgQiIglOhUBEJMGpEIiIJLi4u6HMzIqBrUAuUHLUpqN/rv2+7r/5wL5jOG3dczVnW3PyNZX7WPI2lrWh7U09Fut5W/JeOPqx1s57LO+FpvLqvdv4dr13m+9E51xuvVucc3H5BTzW0M+139fz77LWOFdztjUnXzNytzhvY1kb2t7UY7GetyXvBS/zHst7oRmvqd67LXgvxFveWHnvxvOloVcb+fnVBv5trXM1Z1tz8jX0/fHkberY+rY39Vis523Je6E552xpnqa2HU9evXcb3673bvM1eGzcXRo6Hma2zDUw10YsUl5vxVPeeMoKyuu11s4bzy2CY/FYtAO0kPJ6K57yxlNWUF6vtWrehGoRiIjIv0q0FoGIiNShQiAikuBUCEREEpwKQYSZTTSzR8zsCTNbHO08TTGzJDP7pZk9YGbfjHaeppjZ2Wa2MPIanx3tPE0xsywzW25mF0U7S1PMbEjkdX3ezG6Kdp6mmNmlZva4mb1sZudHO09TzKy/mc0ys+ejnaU+kffqHyOv6dRjeY52UQjM7A9mttfMPq7z+IVmtt7MNprZ9xt7DufcQufcjcBfgD/Gel7gEqAHEACKvMoaydUaeR1QDqTjYd5WygpwNzDXm5RfyNUa7911kffulYCnQyBbKe9LzrnrgWuAr3sYt7XybnbOXedlzrpamPty4PnIa/rVYzphS+9Oi8Uv4ExgNPDxUY8lA5uA/kAq8BEwFBhG+MP+6K8uRx03F+gQ63mB7wM3RI59Pg7yJkWO6wrMjvGs5wFTCH9QXRTrr23kmK8Ci4Gr4iFv5Lh7gNFxlNfT/8+OI/cPgJGRff58LOdLoR1wzi0ws751Hj4d2Oic2wxgZnOAS5xzvwLqbe6bWW+gxDlXGut5zawIqI78WONh3FZ7fSMOAmmeBKXVXttzgCzC/5NVmtnrzrlQrOaNPM8rwCtm9hrwZy+ytlZeMzPgf4A3nHMrvMraWnmjoSW5CbewewIrOcarPO2iEDSgB7D9qJ+LgDFNHHMd8KRniRrX0rzzgAfMbCKwwMtgDWhRXjO7HLgA6Ag86Gmyf9WirM65HwGY2TXAPq+KQCNa+tqeTfjyQBrwupfBGtDS9+6thFtduWY20Dn3iJfh6tHS1zcP+CUwysx+ECkY0dBQ7vuBB83s3zjGKSjacyGweh5r9O4559x/epSlOVqU1zlXQbhwRUtL884jXLyiocXvBQDn3FOtH6VZWvravg287VWYZmhp3vsJf3hFS0vz7gdu9C5Os9Wb2zl3GLj2eJ64XXQWN6AI6HXUzz2BnVHK0hzK6514ygrK67V4y1vLs9ztuRAsBU40s35mlkq48++VKGdqjPJ6J56ygvJ6Ld7y1vIud1v1gnvcw/4MsIvPh1JeF3l8EvAp4Z72H0U7p/Iqq/Iqbyzm1qRzIiIJrj1fGhIRkWZQIRARSXAqBCIiCU6FQEQkwakQiIgkOBUCEZEEp0Ig7YKZlbfx+VplzQoLr9NQYmYfmtknZvbbZhxzqZkNbY3zi4AKgUi9zKzRebicc+Nb8XQLnXOjgFHARWY2oYn9LyU8M6pIq2jPk85JgjOzAcBDQAFQAVzvnPvEzC4Gfkx4Tvf9wFTn3B4z+ylwAtAX2GdmnwK9Cc//3hu4z4UnTMPMyp1z2ZGZP38K7ANOAZYDVzvnnJlNAu6NbFsB9HfONTjNsXOu0sxWEp5lEjO7HpgRybkRmAaMJLz2wFlm9mNgcuTwf/k9j/V1k8SjFoG0Z48BtzrnTgX+HXg48vgiYGzkr/A5wPeOOuZUwnPTXxX5eTDh6bNPB/7TzHz1nGcUcAfhv9L7AxPMLB14FPiKc+4Mwh/SjTKzTsCJfD6t+Dzn3GnOuRHAOsLTDCwmPL/MXc65kc65TY38niLNohaBtEtmlg2MB54Lr4MCfL4gTk/gWTPrTviv7S1HHfqKc67yqJ9fc85VAVVmtpfwCmt1l9r8wDlXFDnvSsItinJgs3Ou9rmfIfzXfX0mmtkq4CTgf5xzuyOPn2Jm/0V4DYds4M0W/p4izaJCIO1VEnDIOTeynm0PAPc651456tJOrcN19q066vsa6v9/pr596ps7viELnXMXmdkgYJGZveicWwk8BVzqnPsoskjO2fUc29jvKdIsujQk7ZILLze6xcy+BuHlEc1sRGRzLrAj8v03PYrwCdD/qOUGm1yk3Tn3KfAr4O7IQznArsjlqKlH7VoW2dbU7ynSLCoE0l5kmlnRUV/fJfzheZ2ZfQSsIby+K4RbAM+Z2ULCHbmtLnJ56Wbgr2a2CNgDlDTj0EeAM82sH/AfwBLg74QLS605wF2RIacDaPj3FGkWTUMt4hEzy3bOlUcWa38I2OCc+120c4nUpRaBiHeuj3QeryF8OerR6MYRqZ9aBCIiCU4tAhGRBKdCICKS4FQIREQSnAqBiEiCUyEQEUlwKgQiIgnu/wONRoItQjwnBwAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://fastai1.fast.ai/callbacks.one_cycle.html">Reference to why we use fit_one_cycle</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.0014</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="n">wd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.896143</td>
      <td>1.822293</td>
      <td>0.354460</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.757242</td>
      <td>1.751968</td>
      <td>0.357080</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.730326</td>
      <td>1.753791</td>
      <td>0.358260</td>
      <td>00:07</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.686104</td>
      <td>1.768173</td>
      <td>0.353260</td>
      <td>00:08</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">,</span> <span class="n">targs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([50000, 9])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.2783, 0.1893, 0.1261, 0.1215, 0.0377, 0.0127, 0.0480, 0.1469, 0.0395]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>50000</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Doing inferences based on this <a href="https://walkwithfastai.com/tab.clas.binary">blog post</a> from Walk With Fastai initially, but then experimenting to get this</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl_test</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">dl_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([100000, 9])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Submission-To-Kaggle">
<a class="anchor" href="#Submission-To-Kaggle" aria-hidden="true"><span class="octicon octicon-link"></span></a>Submission To Kaggle<a class="anchor-link" href="#Submission-To-Kaggle"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#6) [Path('sample_submission.csv'),Path('submission8.csv'),Path('submission9.csv'),Path('tabular-playground-series-jun-2021.zip'),Path('test.csv'),Path('train.csv')]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"sample_submission.csv"</span><span class="p">)</span> <span class="c1">#I could add `low_memory=false` but it makes things slower</span>
<span class="n">df_submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Class_1</th>
      <th>Class_2</th>
      <th>Class_3</th>
      <th>Class_4</th>
      <th>Class_5</th>
      <th>Class_6</th>
      <th>Class_7</th>
      <th>Class_8</th>
      <th>Class_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200000</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200001</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200002</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200003</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200004</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_submission</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Class_1</th>
      <th>Class_2</th>
      <th>Class_3</th>
      <th>Class_4</th>
      <th>Class_5</th>
      <th>Class_6</th>
      <th>Class_7</th>
      <th>Class_8</th>
      <th>Class_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99995</th>
      <td>299995</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>299996</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>299997</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>299998</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>299999</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
      <td>0.1111</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(100000, 100000)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Tensor</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.float32</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds_for_submission</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> 
<span class="n">preds_for_submission</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[0.14556929469108582,
  0.38398420810699463,
  0.0492408387362957,
  0.17785416543483734,
  0.05465058609843254,
  0.019792871549725533,
  0.024652695283293724,
  0.11572658270597458,
  0.028528723865747452]]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'id'</span><span class="p">:</span> <span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">'Predictions'</span><span class="p">:</span> <span class="n">preds</span><span class="o">.</span><span class="n">tolist</span><span class="p">()},</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'Predictions'</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Needed to figure out how to extract the floating point value alone from the list to properly compose the csv output dataframe</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">submission</span><span class="o">.</span><span class="n">Predictions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>pandas.core.series.Series</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">submission</span><span class="o">.</span><span class="n">Predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>float</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">Predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.14556929469108582</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">Predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.14556929469108582,
 0.38398420810699463,
 0.0492408387362957,
 0.17785416543483734,
 0.05465058609843254,
 0.019792871549725533,
 0.024652695283293724,
 0.11572658270597458,
 0.028528723865747452]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Predictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200000</td>
      <td>[0.14556929469108582, 0.38398420810699463, 0.0492408387362957, 0.17785416543483734, 0.05465058609843254, 0.019792871549725533, 0.024652695283293724, 0.11572658270597458, 0.028528723865747452]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200001</td>
      <td>[0.30568018555641174, 0.06748361885547638, 0.2821882963180542, 0.069472536444664, 0.05176167190074921, 0.011320285499095917, 0.08354373276233673, 0.10796741396188736, 0.020582210272550583]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200002</td>
      <td>[0.7500181794166565, 0.026834947988390923, 0.08841108530759811, 0.02269136719405651, 0.009151597507297993, 0.007910830900073051, 0.026987241581082344, 0.05289360508322716, 0.015101218596100807]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200003</td>
      <td>[0.2330009788274765, 0.10760820657014847, 0.23307044804096222, 0.07857377827167511, 0.05705545097589493, 0.02363131381571293, 0.06864532828330994, 0.1658260077238083, 0.03258843347430229]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200004</td>
      <td>[0.3362259268760681, 0.10346393287181854, 0.2263432741165161, 0.08009770512580872, 0.04384588450193405, 0.009048418141901493, 0.0585983507335186, 0.11896053701639175, 0.02341604232788086]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">index</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RangeIndex(start=0, stop=100000, step=1)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="p">[[</span><span class="s1">'Class_1'</span><span class="p">,</span><span class="s1">'Class_2'</span><span class="p">,</span> <span class="s1">'Class_3'</span><span class="p">,</span> <span class="s1">'Class_4'</span><span class="p">,</span> <span class="s1">'Class_5'</span><span class="p">,</span> <span class="s1">'Class_6'</span><span class="p">,</span> <span class="s1">'Class_7'</span><span class="p">,</span> <span class="s1">'Class_8'</span><span class="p">,</span> <span class="s1">'Class_9'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">submission</span><span class="o">.</span><span class="n">Predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span> <span class="n">submission</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Predictions</th>
      <th>Class_1</th>
      <th>Class_2</th>
      <th>Class_3</th>
      <th>Class_4</th>
      <th>Class_5</th>
      <th>Class_6</th>
      <th>Class_7</th>
      <th>Class_8</th>
      <th>Class_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200000</td>
      <td>[0.14556929469108582, 0.38398420810699463, 0.0492408387362957, 0.17785416543483734, 0.05465058609843254, 0.019792871549725533, 0.024652695283293724, 0.11572658270597458, 0.028528723865747452]</td>
      <td>0.145569</td>
      <td>0.383984</td>
      <td>0.049241</td>
      <td>0.177854</td>
      <td>0.054651</td>
      <td>0.019793</td>
      <td>0.024653</td>
      <td>0.115727</td>
      <td>0.028529</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200001</td>
      <td>[0.30568018555641174, 0.06748361885547638, 0.2821882963180542, 0.069472536444664, 0.05176167190074921, 0.011320285499095917, 0.08354373276233673, 0.10796741396188736, 0.020582210272550583]</td>
      <td>0.305680</td>
      <td>0.067484</td>
      <td>0.282188</td>
      <td>0.069473</td>
      <td>0.051762</td>
      <td>0.011320</td>
      <td>0.083544</td>
      <td>0.107967</td>
      <td>0.020582</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200002</td>
      <td>[0.7500181794166565, 0.026834947988390923, 0.08841108530759811, 0.02269136719405651, 0.009151597507297993, 0.007910830900073051, 0.026987241581082344, 0.05289360508322716, 0.015101218596100807]</td>
      <td>0.750018</td>
      <td>0.026835</td>
      <td>0.088411</td>
      <td>0.022691</td>
      <td>0.009152</td>
      <td>0.007911</td>
      <td>0.026987</td>
      <td>0.052894</td>
      <td>0.015101</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200003</td>
      <td>[0.2330009788274765, 0.10760820657014847, 0.23307044804096222, 0.07857377827167511, 0.05705545097589493, 0.02363131381571293, 0.06864532828330994, 0.1658260077238083, 0.03258843347430229]</td>
      <td>0.233001</td>
      <td>0.107608</td>
      <td>0.233070</td>
      <td>0.078574</td>
      <td>0.057055</td>
      <td>0.023631</td>
      <td>0.068645</td>
      <td>0.165826</td>
      <td>0.032588</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200004</td>
      <td>[0.3362259268760681, 0.10346393287181854, 0.2263432741165161, 0.08009770512580872, 0.04384588450193405, 0.009048418141901493, 0.0585983507335186, 0.11896053701639175, 0.02341604232788086]</td>
      <td>0.336226</td>
      <td>0.103464</td>
      <td>0.226343</td>
      <td>0.080098</td>
      <td>0.043846</td>
      <td>0.009048</td>
      <td>0.058598</td>
      <td>0.118961</td>
      <td>0.023416</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"Predictions"</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Class_1</th>
      <th>Class_2</th>
      <th>Class_3</th>
      <th>Class_4</th>
      <th>Class_5</th>
      <th>Class_6</th>
      <th>Class_7</th>
      <th>Class_8</th>
      <th>Class_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>200000</td>
      <td>0.145569</td>
      <td>0.383984</td>
      <td>0.049241</td>
      <td>0.177854</td>
      <td>0.054651</td>
      <td>0.019793</td>
      <td>0.024653</td>
      <td>0.115727</td>
      <td>0.028529</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200001</td>
      <td>0.305680</td>
      <td>0.067484</td>
      <td>0.282188</td>
      <td>0.069473</td>
      <td>0.051762</td>
      <td>0.011320</td>
      <td>0.083544</td>
      <td>0.107967</td>
      <td>0.020582</td>
    </tr>
    <tr>
      <th>2</th>
      <td>200002</td>
      <td>0.750018</td>
      <td>0.026835</td>
      <td>0.088411</td>
      <td>0.022691</td>
      <td>0.009152</td>
      <td>0.007911</td>
      <td>0.026987</td>
      <td>0.052894</td>
      <td>0.015101</td>
    </tr>
    <tr>
      <th>3</th>
      <td>200003</td>
      <td>0.233001</td>
      <td>0.107608</td>
      <td>0.233070</td>
      <td>0.078574</td>
      <td>0.057055</td>
      <td>0.023631</td>
      <td>0.068645</td>
      <td>0.165826</td>
      <td>0.032588</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200004</td>
      <td>0.336226</td>
      <td>0.103464</td>
      <td>0.226343</td>
      <td>0.080098</td>
      <td>0.043846</td>
      <td>0.009048</td>
      <td>0.058598</td>
      <td>0.118961</td>
      <td>0.023416</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'submission10.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">competition_submit</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">'submission10.csv'</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s2">"Tenth pass"</span><span class="p">,</span> <span class="n">competition</span><span class="o">=</span><span class="s1">'tabular-playground-series-jun-2021'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 17.9M/17.9M [00:10&lt;00:00, 1.81MB/s]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Successfully submitted to Tabular Playground Series - Jun 2021</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'tabular-playground-series-jun-2021_fastai_nn9'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('models/tabular-playground-series-jun-2021_fastai_nn9.pth')</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="redditech/reddi-hacking"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/reddi-hacking/kaggle/fastai/2021/06/27/Using-Fastai-For-tabular-playground-series-jun-2021.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/reddi-hacking/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/reddi-hacking/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/reddi-hacking/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My little bits of hacking.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/redditech" title="redditech"><svg class="svg-icon grey"><use xlink:href="/reddi-hacking/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/redditech" title="redditech"><svg class="svg-icon grey"><use xlink:href="/reddi-hacking/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
